# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'dose.ui'
#
# Created by: PyQt5 UI code generator 5.13.0
#
# WARNING! All changes made in this file will be lost!


from PyQt5 import QtCore, QtGui, QtWidgets
from pyqtgraph import PlotWidget, plot
import pyqtgraph as pg
import os
from charts import *
from vibration_dose import *
import threading
class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(800, 616)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.gridLayoutWidget = QtWidgets.QWidget(self.centralwidget)
        self.gridLayoutWidget.setGeometry(QtCore.QRect(150, 50, 631, 421))
        self.gridLayoutWidget.setObjectName("gridLayoutWidget")
        self.graphs_grid = QtWidgets.QGridLayout(self.gridLayoutWidget)
        self.graphs_grid.setContentsMargins(0, 0, 0, 0)
        self.graphs_grid.setObjectName("graphs_grid")
        self.z_graph = QtWidgets.QGraphicsView(self.gridLayoutWidget)
        self.z_graph.setObjectName("z_graph")
        self.graphs_grid.addWidget(self.z_graph, 5, 0, 1, 1)
        self.x_graph = QtWidgets.QGraphicsView(self.gridLayoutWidget)
        self.x_graph.setObjectName("x_graph")
        self.graphs_grid.addWidget(self.x_graph, 1, 0, 1, 1)
        self.x_label = QtWidgets.QLabel(self.gridLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setPointSize(10)
        font.setBold(True)
        font.setWeight(75)
        self.x_label.setFont(font)
        self.x_label.setObjectName("x_label")
        self.graphs_grid.addWidget(self.x_label, 0, 0, 1, 1)
        self.y_graph = QtWidgets.QGraphicsView(self.gridLayoutWidget)
        self.y_graph.setObjectName("y_graph")
        self.graphs_grid.addWidget(self.y_graph, 3, 0, 1, 1)
        self.z_label = QtWidgets.QLabel(self.gridLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setPointSize(10)
        font.setBold(True)
        font.setWeight(75)
        self.z_label.setFont(font)
        self.z_label.setObjectName("z_label")
        self.graphs_grid.addWidget(self.z_label, 4, 0, 1, 1)
        self.y_label = QtWidgets.QLabel(self.gridLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setPointSize(10)
        font.setBold(True)
        font.setWeight(75)
        self.y_label.setFont(font)
        self.y_label.setObjectName("y_label")
        self.graphs_grid.addWidget(self.y_label, 2, 0, 1, 1)
        self.gridLayoutWidget_2 = QtWidgets.QWidget(self.centralwidget)
        self.gridLayoutWidget_2.setGeometry(QtCore.QRect(20, 480, 761, 41))
        self.gridLayoutWidget_2.setObjectName("gridLayoutWidget_2")
        self.flags_grid = QtWidgets.QGridLayout(self.gridLayoutWidget_2)
        self.flags_grid.setContentsMargins(0, 0, 0, 0)
        self.flags_grid.setObjectName("flags_grid")
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.label_2 = QtWidgets.QLabel(self.gridLayoutWidget_2)
        self.label_2.setStyleSheet("background-color: rgb(0, 255, 0);")
        self.label_2.setFrameShape(QtWidgets.QFrame.Box)
        self.label_2.setObjectName("label_2")
        self.horizontalLayout.addWidget(self.label_2)
        self.label_6 = QtWidgets.QLabel(self.gridLayoutWidget_2)
        self.label_6.setStyleSheet("background-color: rgb(255, 255, 0);")
        self.label_6.setFrameShape(QtWidgets.QFrame.Box)
        self.label_6.setObjectName("label_6")
        self.horizontalLayout.addWidget(self.label_6)
        self.label = QtWidgets.QLabel(self.gridLayoutWidget_2)
        self.label.setStyleSheet("background-color: rgb(255, 170, 0);")
        self.label.setFrameShape(QtWidgets.QFrame.Box)
        self.label.setObjectName("label")
        self.horizontalLayout.addWidget(self.label)
        self.label_4 = QtWidgets.QLabel(self.gridLayoutWidget_2)
        self.label_4.setStyleSheet("background-color: rgb(255, 85, 0);")
        self.label_4.setFrameShape(QtWidgets.QFrame.Box)
        self.label_4.setObjectName("label_4")
        self.horizontalLayout.addWidget(self.label_4)
        self.label_5 = QtWidgets.QLabel(self.gridLayoutWidget_2)
        self.label_5.setStyleSheet("background-color: rgb(255, 0, 0);")
        self.label_5.setFrameShape(QtWidgets.QFrame.Box)
        self.label_5.setObjectName("label_5")
        self.horizontalLayout.addWidget(self.label_5)
        self.label_3 = QtWidgets.QLabel(self.gridLayoutWidget_2)
        self.label_3.setStyleSheet("background-color: rgb(0, 0, 0);\n"
"color: rgb(255, 255, 255);")
        self.label_3.setFrameShape(QtWidgets.QFrame.Box)
        self.label_3.setObjectName("label_3")
        self.horizontalLayout.addWidget(self.label_3)
        self.flags_grid.addLayout(self.horizontalLayout, 0, 0, 1, 1)
        self.gridLayoutWidget_3 = QtWidgets.QWidget(self.centralwidget)
        self.gridLayoutWidget_3.setGeometry(QtCore.QRect(20, 50, 121, 421))
        self.gridLayoutWidget_3.setObjectName("gridLayoutWidget_3")
        self.info_grid = QtWidgets.QGridLayout(self.gridLayoutWidget_3)
        self.info_grid.setContentsMargins(0, 0, 0, 0)
        self.info_grid.setObjectName("info_grid")
        self.gridLayout_4 = QtWidgets.QGridLayout()
        self.gridLayout_4.setObjectName("gridLayout_4")
        self.ex_label = QtWidgets.QLabel(self.gridLayoutWidget_3)
        self.ex_label.setObjectName("ex_label")
        self.gridLayout_4.addWidget(self.ex_label, 0, 1, 1, 1)
        self.ez_label = QtWidgets.QLabel(self.gridLayoutWidget_3)
        self.ez_label.setObjectName("ez_label")
        self.gridLayout_4.addWidget(self.ez_label, 2, 1, 1, 1)
        spacerItem = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_4.addItem(spacerItem, 1, 0, 1, 1)
        self.ey_label = QtWidgets.QLabel(self.gridLayoutWidget_3)
        self.ey_label.setObjectName("ey_label")
        self.gridLayout_4.addWidget(self.ey_label, 1, 1, 1, 1)
        spacerItem1 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_4.addItem(spacerItem1, 1, 3, 1, 1)
        self.ex_value = QtWidgets.QLabel(self.gridLayoutWidget_3)
        self.ex_value.setObjectName("ex_value")
        self.gridLayout_4.addWidget(self.ex_value, 0, 2, 1, 1)
        self.ey_value = QtWidgets.QLabel(self.gridLayoutWidget_3)
        self.ey_value.setObjectName("ey_value")
        self.gridLayout_4.addWidget(self.ey_value, 1, 2, 1, 1)
        self.ez_value = QtWidgets.QLabel(self.gridLayoutWidget_3)
        self.ez_value.setObjectName("ez_value")
        self.gridLayout_4.addWidget(self.ez_value, 2, 2, 1, 1)
        self.info_grid.addLayout(self.gridLayout_4, 0, 0, 1, 1)
        self.gridLayout_5 = QtWidgets.QGridLayout()
        self.gridLayout_5.setObjectName("gridLayout_5")
        spacerItem2 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_5.addItem(spacerItem2, 0, 2, 1, 1)
        self.end_btn = QtWidgets.QPushButton(self.gridLayoutWidget_3)
        self.end_btn.setObjectName("end_btn")
        self.gridLayout_5.addWidget(self.end_btn, 1, 1, 1, 1)
        self.start_btn = QtWidgets.QPushButton(self.gridLayoutWidget_3)
        self.start_btn.setObjectName("start_btn")
        self.gridLayout_5.addWidget(self.start_btn, 0, 1, 1, 1)
        spacerItem3 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_5.addItem(spacerItem3, 0, 0, 1, 1)
        self.info_grid.addLayout(self.gridLayout_5, 1, 0, 1, 1)
        self.horizontalLayoutWidget_7 = QtWidgets.QWidget(self.centralwidget)
        self.horizontalLayoutWidget_7.setGeometry(QtCore.QRect(20, 10, 761, 41))
        self.horizontalLayoutWidget_7.setObjectName("horizontalLayoutWidget_7")
        self.title_grid = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_7)
        self.title_grid.setContentsMargins(0, 0, 0, 0)
        self.title_grid.setObjectName("title_grid")
        spacerItem4 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.title_grid.addItem(spacerItem4)
        self.dose_label = QtWidgets.QLabel(self.horizontalLayoutWidget_7)
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setPointSize(20)
        font.setBold(True)
        font.setWeight(75)
        self.dose_label.setFont(font)
        self.dose_label.setObjectName("dose_label")
        self.title_grid.addWidget(self.dose_label)
        spacerItem5 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.title_grid.addItem(spacerItem5)
        self.horizontalLayoutWidget_3 = QtWidgets.QWidget(self.centralwidget)
        self.horizontalLayoutWidget_3.setGeometry(QtCore.QRect(20, 520, 761, 41))
        self.horizontalLayoutWidget_3.setObjectName("horizontalLayoutWidget_3")
        self.progress_grid = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_3)
        self.progress_grid.setContentsMargins(0, 0, 0, 0)
        self.progress_grid.setObjectName("progress_grid")
        self.progressBar = QtWidgets.QProgressBar(self.horizontalLayoutWidget_3)
        self.progressBar.setMaximum(60)
        self.progressBar.setProperty("value", 0)
        self.progressBar.setTextVisible(False)
        self.progressBar.setObjectName("progressBar")
        self.progress_grid.addWidget(self.progressBar)
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 800, 21))
        self.menubar.setObjectName("menubar")
        self.menuP_gina_Inicial = QtWidgets.QMenu(self.menubar)
        self.menuP_gina_Inicial.setObjectName("menuP_gina_Inicial")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)
        self.actionSAIR = QtWidgets.QAction(MainWindow)
        self.actionSAIR.setObjectName("actionSAIR")
        self.menuP_gina_Inicial.addAction(self.actionSAIR)
        self.menubar.addAction(self.menuP_gina_Inicial.menuAction())

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

        c = charts()
        time.sleep(1)
        #print (print (ReadRoutine().sensors.list_s[0].g))
        c.start_chart()
        t = threading.Thread(target=c.update_chart, args=())
        t.start()
        t2 = threading.Thread(target=self.calc_routine, args=())
        t2.start()
        
    def changeProgress(self, value):
        self.progressBar.setValue(value)
        
    def calc_routine(self):
        while len(ReadRoutine().sensors.rtc)==0:
            time.sleep(0.01)
        v = VibrationDose(ReadRoutine().sensors.rtc,ReadRoutine().sensors.list_s[1].a[0],
        ReadRoutine().sensors.list_s[1].a[1],ReadRoutine().sensors.list_s[1].a[2])
        while True:
            v.sum_vibration(ReadRoutine().sensors.rtc,ReadRoutine().sensors.list_s[1].a[0],
            ReadRoutine().sensors.list_s[1].a[1],ReadRoutine().sensors.list_s[1].a[2])
            print(round(v.total, 2))
            print((round(v.total, 2)) * 10)
            self.changeProgress((round(v.total,2)))
            time.sleep(0.01)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "SensorsProject - Dose"))
        self.x_label.setText(_translate("MainWindow", "X"))
        self.z_label.setText(_translate("MainWindow", "Z"))
        self.y_label.setText(_translate("MainWindow", "Y"))
        self.label_2.setText(_translate("MainWindow", " 0"))
        self.label_6.setText(_translate("MainWindow", " 1"))
        self.label.setText(_translate("MainWindow", " 2"))
        self.label_4.setText(_translate("MainWindow", "3"))
        self.label_5.setText(_translate("MainWindow", " 4"))
        self.label_3.setText(_translate("MainWindow", " 5 (Máximo)"))
        self.ex_label.setText(_translate("MainWindow", "Eixo X :"))
        self.ez_label.setText(_translate("MainWindow", "Eixo Z :"))
        self.ey_label.setText(_translate("MainWindow", "Eixo Y :"))
        self.ex_value.setText(_translate("MainWindow", "Value X"))
        self.ey_value.setText(_translate("MainWindow", "Value Y"))
        self.ez_value.setText(_translate("MainWindow", "Value Z"))
        self.end_btn.setText(_translate("MainWindow", "Fim"))
        self.start_btn.setText(_translate("MainWindow", "Início"))
        self.dose_label.setText(_translate("MainWindow", "Dose de Vibração"))
        self.menuP_gina_Inicial.setTitle(_translate("MainWindow", "MENU"))
        self.actionSAIR.setText(_translate("MainWindow", "Página Inicial"))


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
